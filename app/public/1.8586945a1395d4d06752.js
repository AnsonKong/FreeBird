(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{182:function(t,e,n){"use strict";var s=n(57);n(191);const a=n(190);var i={data(){return{initY:this.$store.state.navHeaderHeight-50,maxDistance:200,refreshDistance:150,transitionDuration:.5,active:!1,startY:0,moveY:0,touchEnabled:!1,doRefresh:!1,currentDistance:0}},methods:{onTouchStart(t){this.touchEnabled=!0,0===window.scrollY&&1===t.touches.length&&(this.startY=t.touches[0].clientY,window.addEventListener("touchmove",this.onTouchMove))},onMouseStart(t){this.touchEnabled||0!==window.scrollY||(this.startY=t.clientY,document.body.addEventListener("mousemove",this.onMouseMove))},onMouseMove(t){this.touchEnabled||(this.moveY=t.clientY,this._moveCalculate())},onTouchMove(t){this.startY&&1===t.touches.length&&(this.moveY=t.touches[0].clientY,this._moveCalculate())},_moveCalculate(){const t=this.moveY-this.startY;this.active?(this.currentDistance=Math.min(this.maxDistance,this.initY+t),this.doRefresh=this.currentDistance>this.refreshDistance,this.$refs.myContainer.style.top=this.currentDistance+"px",this.$refs.myIcon.style.opacity=this.doRefresh?1:.5):t>0?this._start():this._cancel()},onEnd(t){const e=Circ.easeOut;s.TweenLite.to(this.$refs.myContainer,this.transitionDuration,{top:`${this.initY}px`,ease:e,onComplete:()=>{this.doRefresh&&this.$emit("refresh"),this._cancel()}}),s.TweenLite.to(this.$data,this.transitionDuration,{currentDistance:0,ease:e})},_start(){this.active=!0,a.stopScroll(),this.touchEnabled?window.addEventListener("touchend",this.onEnd):window.addEventListener("mouseup",this.onEnd)},_cancel(){this.active=!1,this.startY=0,this.moveY=0,this.doRefresh=!1,a.startScroll(),window.removeEventListener("touchend",this.onEnd),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onEnd),document.body.removeEventListener("mousemove",this.onMouseMove)}},activated(){window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousedown",this.onMouseStart)},deactivated(){window.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousedown",this.onMouseStart),this._cancel()}},o=(n(189),n(2)),r=Object(o.a)(i,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container",class:[this.active?"container-active":null]},[e("div",{ref:"myContainer",staticClass:"icon-container"},[e("i",{ref:"myIcon",staticClass:"iconfont icon-reload",style:{transform:"rotate("+360*this.currentDistance/this.maxDistance+"deg)"}})])])},[],!1,null,"392d4065",null);e.a=r.exports},183:function(t,e,n){var s=n(196);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n(4).default)("03deaafe",s,!0,{})},184:function(t,e,n){var s=n(198);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n(4).default)("6d52ae14",s,!0,{})},185:function(t,e,n){var s=n(200);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n(4).default)("0dc8a338",s,!0,{})},188:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,"\n.icon-reload[data-v-392d4065] {\n  font-size: 30px;\n  line-height: 50px;\n  color: #6fa9b3;\n  display: inline-block;\n}\n.container[data-v-392d4065] {\n  position: fixed;\n  background: rgba(0,0,0,0.2);\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  visibility: hidden;\n}\n.container-active[data-v-392d4065] {\n  visibility: visible;\n}\n.icon-container[data-v-392d4065] {\n  width: 50px;\n  height: 50px;\n  border-radius: 50px;\n  background: #fff;\n  position: absolute;\n  top: 80px;\n  left: calc(50% - 25px);\n  text-align: center;\n}\n",""])},189:function(t,e,n){"use strict";var s=n(55);n.n(s).a},190:function(t,e){t.exports={stopScroll(){document.body.style.overflow="hidden"},startScroll(){document.body.style.overflow="auto"}}},193:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,"\n.iconfont[data-v-128025e4] {\n  color: #aaa;\n  font-size: 25px;\n}\n.heart[data-v-128025e4] {\n  opacity: 0;\n  position: absolute;\n  left: 0;\n}\n.like-container[data-v-128025e4] {\n  display: inline-block;\n  position: relative;\n}\n.like[data-v-128025e4] {\n  color: #aaa;\n  font-size: 20px;\n}\n",""])},194:function(t,e,n){"use strict";var s=n(56);n.n(s).a},195:function(t,e,n){var s={"./af":181,"./af.js":181,"./ar":180,"./ar-dz":179,"./ar-dz.js":179,"./ar-kw":178,"./ar-kw.js":178,"./ar-ly":177,"./ar-ly.js":177,"./ar-ma":176,"./ar-ma.js":176,"./ar-sa":175,"./ar-sa.js":175,"./ar-tn":174,"./ar-tn.js":174,"./ar.js":180,"./az":173,"./az.js":173,"./be":172,"./be.js":172,"./bg":171,"./bg.js":171,"./bm":170,"./bm.js":170,"./bn":169,"./bn.js":169,"./bo":168,"./bo.js":168,"./br":167,"./br.js":167,"./bs":166,"./bs.js":166,"./ca":165,"./ca.js":165,"./cs":164,"./cs.js":164,"./cv":163,"./cv.js":163,"./cy":162,"./cy.js":162,"./da":161,"./da.js":161,"./de":160,"./de-at":159,"./de-at.js":159,"./de-ch":158,"./de-ch.js":158,"./de.js":160,"./dv":157,"./dv.js":157,"./el":156,"./el.js":156,"./en-au":155,"./en-au.js":155,"./en-ca":154,"./en-ca.js":154,"./en-gb":153,"./en-gb.js":153,"./en-ie":152,"./en-ie.js":152,"./en-il":151,"./en-il.js":151,"./en-nz":150,"./en-nz.js":150,"./eo":149,"./eo.js":149,"./es":148,"./es-do":147,"./es-do.js":147,"./es-us":146,"./es-us.js":146,"./es.js":148,"./et":145,"./et.js":145,"./eu":144,"./eu.js":144,"./fa":143,"./fa.js":143,"./fi":142,"./fi.js":142,"./fo":141,"./fo.js":141,"./fr":140,"./fr-ca":139,"./fr-ca.js":139,"./fr-ch":138,"./fr-ch.js":138,"./fr.js":140,"./fy":137,"./fy.js":137,"./gd":136,"./gd.js":136,"./gl":135,"./gl.js":135,"./gom-latn":134,"./gom-latn.js":134,"./gu":133,"./gu.js":133,"./he":132,"./he.js":132,"./hi":131,"./hi.js":131,"./hr":130,"./hr.js":130,"./hu":129,"./hu.js":129,"./hy-am":128,"./hy-am.js":128,"./id":127,"./id.js":127,"./is":126,"./is.js":126,"./it":125,"./it.js":125,"./ja":124,"./ja.js":124,"./jv":123,"./jv.js":123,"./ka":122,"./ka.js":122,"./kk":121,"./kk.js":121,"./km":120,"./km.js":120,"./kn":119,"./kn.js":119,"./ko":118,"./ko.js":118,"./ky":117,"./ky.js":117,"./lb":116,"./lb.js":116,"./lo":115,"./lo.js":115,"./lt":114,"./lt.js":114,"./lv":113,"./lv.js":113,"./me":112,"./me.js":112,"./mi":111,"./mi.js":111,"./mk":110,"./mk.js":110,"./ml":109,"./ml.js":109,"./mn":108,"./mn.js":108,"./mr":107,"./mr.js":107,"./ms":106,"./ms-my":105,"./ms-my.js":105,"./ms.js":106,"./mt":104,"./mt.js":104,"./my":103,"./my.js":103,"./nb":102,"./nb.js":102,"./ne":101,"./ne.js":101,"./nl":100,"./nl-be":99,"./nl-be.js":99,"./nl.js":100,"./nn":98,"./nn.js":98,"./pa-in":97,"./pa-in.js":97,"./pl":96,"./pl.js":96,"./pt":95,"./pt-br":94,"./pt-br.js":94,"./pt.js":95,"./ro":93,"./ro.js":93,"./ru":92,"./ru.js":92,"./sd":91,"./sd.js":91,"./se":90,"./se.js":90,"./si":89,"./si.js":89,"./sk":88,"./sk.js":88,"./sl":87,"./sl.js":87,"./sq":86,"./sq.js":86,"./sr":85,"./sr-cyrl":84,"./sr-cyrl.js":84,"./sr.js":85,"./ss":83,"./ss.js":83,"./sv":82,"./sv.js":82,"./sw":81,"./sw.js":81,"./ta":80,"./ta.js":80,"./te":79,"./te.js":79,"./tet":78,"./tet.js":78,"./tg":77,"./tg.js":77,"./th":76,"./th.js":76,"./tl-ph":75,"./tl-ph.js":75,"./tlh":74,"./tlh.js":74,"./tr":73,"./tr.js":73,"./tzl":72,"./tzl.js":72,"./tzm":71,"./tzm-latn":70,"./tzm-latn.js":70,"./tzm.js":71,"./ug-cn":69,"./ug-cn.js":69,"./uk":68,"./uk.js":68,"./ur":67,"./ur.js":67,"./uz":66,"./uz-latn":65,"./uz-latn.js":65,"./uz.js":66,"./vi":64,"./vi.js":64,"./x-pseudo":63,"./x-pseudo.js":63,"./yo":62,"./yo.js":62,"./zh-cn":61,"./zh-cn.js":61,"./zh-hk":60,"./zh-hk.js":60,"./zh-tw":59,"./zh-tw.js":59};function a(t){var e=i(t);return n(e)}function i(t){var e=s[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}a.keys=function(){return Object.keys(s)},a.resolve=i,t.exports=a,a.id=195},196:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,"\n.hr[data-v-0fe009c9] {\n  height: 1px;\n  background: #ddd;\n  margin-bottom: 10px;\n}\n.non-comment[data-v-0fe009c9] {\n  color: #ccc;\n}\n.comment-container[data-v-0fe009c9] {\n  margin: 25px 0;\n}\n.comments-title[data-v-0fe009c9] {\n  font-size: 20px;\n}\n.input-nav[data-v-0fe009c9] {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n.iconfont[data-v-0fe009c9] {\n  font-size: 25px;\n  color: #aaa;\n}\n.icon-heart[data-v-0fe009c9] {\n  margin: 0 5px;\n}\n.icon-container[data-v-0fe009c9] {\n  margin-top: 25px;\n}\n.avatar-container[data-v-0fe009c9] {\n  text-align: center;\n  padding: 15px;\n}\n.author[data-v-0fe009c9] {\n  text-align: center;\n  font-weight: bold;\n}\n.content-container[data-v-0fe009c9] {\n  padding: 15px;\n}\n.comments-container[data-v-0fe009c9] {\n  padding: 15px;\n  padding-bottom: 50px;\n}\n.content[data-v-0fe009c9] {\n  font-size: 20px;\n}\n.time[data-v-0fe009c9] {\n  text-align: right;\n  color: #ccc;\n}\n",""])},197:function(t,e,n){"use strict";var s=n(183);n.n(s).a},198:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,"\n.user[data-v-234fcd0d] {\n  font-weight: bold;\n}\n.info-container[data-v-234fcd0d] {\n  margin-bottom: 10px;\n  display: flex;\n  justify-content: space-between;\n}\n.container[data-v-234fcd0d] {\n  display: flex;\n}\n.my-avatar[data-v-234fcd0d] {\n  flex-shrink: 0;\n}\n.main-container[data-v-234fcd0d] {\n  margin-left: 10px;\n  width: 100%;\n}\n",""])},199:function(t,e,n){"use strict";var s=n(184);n.n(s).a},200:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,"\ntextarea[data-v-6a4d07ca] {\n  border: solid 0;\n  border-bottom: solid 1px #ccc;\n  width: 100%;\n  font-size: 20px;\n  resize: none;\n  box-sizing: border-box;\n  margin-right: 10px;\n}\ntextarea[data-v-6a4d07ca]:focus {\n  border-bottom: solid 1px #6fa9b3;\n}\n.container[data-v-6a4d07ca] {\n  border-top: solid 1px #ccc;\n  background: #fff;\n  display: flex;\n  align-items: flex-end;\n  padding: 10px;\n  box-shadow: 0 0 2px 1px rgba(0,0,0,0.2);\n}\n",""])},201:function(t,e,n){"use strict";var s=n(185);n.n(s).a},211:function(t,e,n){"use strict";n.r(e);var s=n(14),a={data:()=>({currentValue:"",lines:1}),mounted(){this._updateInputHeight()},deactivated(){this._clear()},methods:{onSend(){this.currentValue&&(this.$emit("send",this.currentValue),this._clear())},onInput(){this._updateInputHeight()},_updateInputHeight(){const t=this.currentValue.match(/\n/gm);this.lines=1+(t?t.length:0)},_clear(){this.currentValue="",this.lines=1}}},i=(n(201),n(2)),o=Object(i.a)(a,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],ref:"myInput",attrs:{placeholder:"comment here",rows:t.lines},domProps:{value:t.currentValue},on:{input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.onInput]}}),n("div",{staticClass:"c-btn c-btn--white c-btn--small c-btn--round c-btn--narrow",class:[t.currentValue?null:"c-btn--disabled"],on:{click:t.onSend}},[t._v("Send")])])},[],!1,null,"6a4d07ca",null).exports,r=n(13),c=n(58),l={props:["item"],components:{avatar:r.a,heart:c.a}},d=(n(199),Object(i.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("avatar",{staticClass:"my-avatar",attrs:{"avatar-width":"40px","bg-color":"#eee","icon-color":"#aaa",round:!1,"avatar-url":t.item.user?t.item.user.avatar_url:null}}),n("div",{staticClass:"main-container"},[n("div",{staticClass:"info-container"},[n("span",{staticClass:"user"},[t._v(t._s(t.item.user?t.item.user.name:"annoymous"))]),n("heart",{attrs:{item:t.item,api:"/api/comment/like"}})],1),n("div",{staticClass:"comment",domProps:{innerHTML:t._s(t.input2Html(t.item.comment))}})])],1)},[],!1,null,"234fcd0d",null).exports),h=n(182),m=n(57);const u=n(23),v=n(54);var f={components:{"nav-menu":s.a,avatar:r.a,comment:d,heart:c.a,"input-nav":o,refresh:h.a},data:()=>({article:{},shareLink:"",total:0,comments:[]}),computed:{articleId(){return this.$route.params.id},time(){return this.article.time?v(this.article.time).fromNow():"time"}},methods:{loadArticle(){u.get(`/api/article/${this.articleId}`).then(t=>{this.article=t.data,this.total=this.article.comments_count,this.shareLink=`${window.location.origin}/article/${this.article._id}`,this.loadComments()}).catch(t=>{this.toast("load error "+t)})},loadComments(){u.get("/api/comments",{params:{article:this.articleId}}).then(t=>{t.data?(this.comments=this.comments.concat(t.data),this.$nextTick(function(){if(this.$route.hash){const t=this.$route.hash.replace("#","");if(this.$refs[t]){const e=this.$refs[t][0].getBoundingClientRect();window.scrollTo(0,e.top-this.$store.state.navHeaderHeight)}}})):this.comments.length&&this.toast("no more comments.")}).catch(t=>{this.toast("load error, please check your network.")})},commentArticle(t){u.post("/api/comments",{article:this.articleId,comment:t}).then(t=>{this.total++,this.comments.unshift(t.data),this.toast("comment successfully!"),this.$nextTick(function(){const t=this.$refs["comment-list"].firstChild;m.TweenLite.fromTo(t,.5,{opacity:0},{opacity:1})}),this._scrollToCommentsTop()}).catch(t=>{this.toast("comment error "+t)})},onSend(t){this.commentArticle(t)},onRefresh(){this.toast("refresh successfully!"),this._clear(),this.loadArticle()},_scrollToCommentsTop(){const t=this.$refs["comments-container"].getBoundingClientRect();window.scrollBy(0,t.top-this.$store.state.navHeaderHeight)},_clear(){this.article={},this.shareLink="",this.total=0,this.comments.length=0}},activated(){this.loadArticle()},deactivated(){this._clear()}},p=(n(197),Object(i.a)(f,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"root-container"},[n("nav-menu",{staticClass:"head head-stick"}),n("div",{staticClass:"avatar-container"},[n("avatar",{attrs:{"avatar-url":t.article.avatar?t.article.avatar:null,"bg-color":"#eee","icon-color":"#aaa"}}),n("div",{staticClass:"author"},[t._v(t._s(t.article.author?t.article.author:"annoymous"))])],1),n("div",{staticClass:"content-container"},[n("div",{staticClass:"time"},[t._v(t._s(t.time))]),n("div",{staticClass:"content"},[t._v(t._s(t.article.content?t.article.content:"empty content"))]),n("div",{staticClass:"icon-container"},[n("i",{staticClass:"iconfont icon-share copy",attrs:{"data-clipboard-text":t.shareLink}}),n("heart",{attrs:{item:t.article,api:"/api/article/like"}})],1)]),n("div",{staticClass:"hr"}),n("div",{ref:"comments-container",staticClass:"comments-container"},[n("div",{staticClass:"comments-title"},[t._v("Comments ("+t._s(t.total)+")")]),n("ul",{ref:"comment-list"},t._l(t.comments,function(t,e){return n("li",{key:t._id,ref:t._id,refInFor:!0,staticClass:"comment-container"},[n("div",{staticClass:"hr"}),n("comment",{attrs:{item:t}})],1)})),0===t.comments.length?n("div",{staticClass:"non-comment"},[t._v("Leave a comment?")]):t._e()]),n("input-nav",{staticClass:"input-nav",on:{send:t.onSend}}),n("refresh",{on:{refresh:t.onRefresh}})],1)},[],!1,null,"0fe009c9",null));e.default=p.exports},55:function(t,e,n){var s=n(188);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n(4).default)("2b833ecb",s,!0,{})},56:function(t,e,n){var s=n(193);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,n(4).default)("75b6a4be",s,!0,{})},58:function(t,e,n){"use strict";var s=n(57);const a=n(23);var i={props:["item","api"],data:()=>({like:!1,likePopTop:"-30px"}),methods:{onHeart(){a.post(this.api,{id:this.item._id}).then(t=>{0===t.data.code?(this.like=!0,void 0==this.item.like?this.$set(this.item,"like",1):this.item.like++,s.TweenLite.fromTo(this.$refs.myHeart,.5,{top:"0",opacity:1},{top:this.likePopTop,opacity:0})):this.toast("like failed: "+t.data.code)}).catch(t=>{this.toast("like failed: "+t)})}}},o=(n(194),n(2)),r=Object(o.a)(i,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"like-container",on:{click:this.onHeart}},[e("i",{ref:"myHeart",staticClass:"iconfont icon-heart-fill heart"}),e("i",{class:["iconfont",this.like?"icon-heart-fill":"icon-heart"]}),e("span",{staticClass:"like"},[this._v(this._s(this.item.like))])])},[],!1,null,"128025e4",null);e.a=r.exports}}]);